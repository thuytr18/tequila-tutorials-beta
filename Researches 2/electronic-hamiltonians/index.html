<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jakob Kottmann">
<meta name="dcterms.date" content="2022-11-10">

<title>Tequila Tutorials - Electronic Hamiltonians</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-V7DRP5E70N"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-V7DRP5E70N', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Tequila Tutorials - Electronic Hamiltonians">
<meta property="og:description" content="quantum computing, quantum chemistry and tequila">
<meta property="og:image" content="https://thuytr18.github.io/tequila-tutorials-beta/Researches 2/electronic-hamiltonians/Preview_Hamiltonian.png">
<meta property="og:site_name" content="Tequila Tutorials">
<meta property="og:image:height" content="1792">
<meta property="og:image:width" content="2486">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../tequila_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Tequila Tutorials</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../FAQ/FAQ.html"> 
<span class="menu-text">FAQ</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Contribution/Contribution.html"> 
<span class="menu-text">Contribution</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Electronic Hamiltonians</h1>
  <div class="quarto-categories">
    <div class="quarto-category">chemistry</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jakob Kottmann </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 10, 2022</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="electronic-hamiltonians" class="level1">
<h1>Electronic Hamiltonians</h1>
<p>What are electronic Hamiltonians and how can we construct them?</p>
<center>
<img src="hamiltonian.png" class="img-fluid" width="400">
</center>
<section id="tldr" class="level2">
<h2 class="anchored" data-anchor-id="tldr">tldr:</h2>
<p><strong>First Quantized Formulation</strong>:</p>
<ul>
<li>Hamiltonian is directly defined from the nuclear coordinates and charges<br>
</li>
<li>Spin and Fermionic anti-symmetry need to be imposed on the wavefunctions<br>
</li>
<li>Particle number is fixed<br>
</li>
<li>Explicit computation of matrix representation unfeasible without approximations</li>
</ul>
<p><strong>Second Quantized Formulation</strong>:</p>
<ul>
<li>Needs a set of orbitals to be constructed<br>
</li>
<li>Spin and Fermionic anti-symmetry included in Hamiltonian<br>
</li>
<li>Particle number is not fixed<br>
</li>
<li>Explicit construction in finite basis feasible</li>
</ul>
</section>
<section id="first-quantized-formulation" class="level2">
<h2 class="anchored" data-anchor-id="first-quantized-formulation">First Quantized Formulation</h2>
<p>The word molecule often stands for <span class="math inline">\(N_\text{e}\)</span> electrons with coordinates <span class="math inline">\(r_k\)</span> moving in a potential created by atomic nuclei - assumed to be fixed point-charges with coordinates <span class="math inline">\(R_A\)</span> and charges <span class="math inline">\(N_A\)</span>. The electronic Hamiltonian is then the operator expressing the interactions of the electrons in that potential <span class="math display">\[H =  \sum_{k}^{N_\text{e}} h\left(r_k\right) + \sum_{k}^{N_\text{e}} \sum_{l&lt;k} g\left(r_k,r_l\right) + V_\text{nn}.\]</span> We write it three parts and a constant, which are in atomic units:</p>
<ol type="1">
<li>One-body interactions: <span class="math display">\[ h(r) = T(r) + V_\text{ne}(r) \]</span> including the kinetic energy of the electrons and the Coulombic attraction between electrons and nuclear charges<br>
<span class="math display">\[T(r) = -\frac{1}{2} {\nabla^2_{r}}, \quad V_{\text{ne}}(r) = \sum_{A \in \text{nuclei}} \frac{N_A}{\|r-R_A\|}.\]</span><br>
</li>
<li>Two-body interactions: the Coulombic repulsion between individual electrons<br>
<span class="math display">\[g(r_k,r_l) = \frac{1}{\| r_k - r_l \|}\]</span><br>
</li>
<li>A constant term: Coulombic repulsion between the nuclear charges<br>
<span class="math display">\[V_\text{nn} = \sum_{A&lt;B} \frac{N_A N_B}{\|R_A - R_b\|} \]</span><br>
which is just a constant for a given molecular structure.</li>
</ol>
<p>With this, we have fully defined it, and the lowest eigenvalue of this differential operator gives the corresponding ground state energy. To ensure that the ground state describes a multi-electron system, we must impose restrictions on the wavefunction - Fermions have a spin and anti-symmetric permutation symmetry.</p>
<section id="fermions-and-anti-symmetry" class="level3">
<h3 class="anchored" data-anchor-id="fermions-and-anti-symmetry">Fermions and Anti-Symmetry</h3>
<p>As we are describing electrons, they need to obey fermionic antisymmetry. In first quantization (or real-space formulation), the Hamiltonian does not have that property included, so without restrictions on the wavefunctions, it only describes <span class="math inline">\(N_\text{e}\)</span> negatively charged point-particles without any permutation symmetries or spin.</p>
<p>We can add spin conveniently by defining a single-electron wavefunction as a so called spin-orbital: A three-dimensional function <span class="math inline">\(\psi(r) \in \mathcal{L}^2(\mathbb{R}^3)\)</span>, describing the electron in spatial space, augmented with a spin-state <span class="math display">\[\lvert\sigma\rangle \in \text{Span}\left\{\lvert \uparrow \rangle, \lvert \downarrow \rangle\right\} \equiv \mathbb{C}^2.\]</span> If the set of spatial orbitals <span class="math inline">\(\psi_k\)</span> forms a complete basis in <span class="math inline">\(\mathcal{L}^2(\mathbb{R}^3)\)</span>, we have an exact description of the electron. A convenient notation is to express the spin component as a function of a spin-coordinate <span class="math inline">\(s\left\{-1,1\right\}\)</span> and combine spin coordinate <span class="math inline">\(s\)</span> and spatial coordinate <span class="math inline">\(r\)</span> to <span class="math inline">\(x=(r,s)\)</span>. In a given set of <span class="math inline">\(M\)</span> spatial orbital, an arbitrary one electron wavefunction can then be expressed as <span class="math display">\[
\Psi(x) = \sum_k^{2M} c_k \phi(x) = \sum_{l}^{M} \psi_{l}(r)\otimes \left( c_{2l}\lvert \uparrow \rangle + c_{2l+1} \lvert \downarrow \rangle \right)
\]</span> with the spin-orbitals defined as <span class="math display">\[
\phi_k = \psi_{\lfloor{i/2}\rfloor} \otimes \lvert \sigma(k) \rangle,\; \sigma_k=\begin{cases} \lvert \uparrow \rangle,\; k \text{ is even}  \\  \lvert \uparrow \rangle,\; k \text{ is odd}  \end{cases}.  
\]</span> Many electron functions can then be constructed as linear combinations of anti-symmetric products of single electron functions (so called Slater-Determinants). <span class="math display">\[
\Psi\left(x_1, \dots, x_{N_\text{e}}\right) = \sum_{m} d_m \det\left(\phi_{m_1},\dots, \phi_{m_{N_\text{e}}}\right) \
\]</span></p>
</section>
</section>
<section id="second-quantization" class="level2">
<h2 class="anchored" data-anchor-id="second-quantization">Second Quantization</h2>
<p>Using second quantized language, we can significantly simplify the treatment of electron spin and anti-symmetry with the help of abstract field operators <span class="math inline">\(\hat{\phi}^\dagger(x)\)</span> (<span class="math inline">\(\hat{\phi}(x)\)</span>) that create (or annihilate) electrons at spin-position <span class="math inline">\(x\)</span>. With them, we can formaly write the electronic Hamiltonian as <span class="math display">\[H = \int \hat{\phi}^\dagger(x) h(x) \hat{\phi}(x) \operatorname{x}x + \int \int \hat{\phi}^\dagger(x)\hat{\phi}^\dagger(y) g(x,y) \hat{\phi}(x)\hat{\phi}(y) \operatorname{d}x\operatorname{d}y+ V_\text{nn}.\]</span> The wavefunction is now only required to carry information about electron occupancies at all points in space. When acting on the wavefunction, the one-body part of the operator is first annihilating an electron at point <span class="math inline">\(x\)</span>. If no electron is present, this will lead to an energy contribution of zero and otherwise invoke <span class="math inline">\(h(x)\)</span>, followed by the restoration of the electron by the creation operator. The two-body part acts in the same way and the integrals ensure that we probe all points in space. In practice, this is unfeasible, and it is convenient to introduce a finite basis in the form of spin orbitals to expand the field operators as <span class="math display">\[\hat{\phi}(x) = \sum_k \phi(x)_k a_k, \]</span> leading to the more prominent form of the second quantized Hamiltonian <span class="math display">\[
H = \sum_{ij} \tilde{h}^i{j}a^\dagger_i a_j \sum_{ijkl} \tilde{g}^{ij}_{kl} a^\dagger_i a^\dagger_j a_l a_k + V_\text{nn}.
\]</span> The new discretized operators <span class="math inline">\(a^\dagger_k\)</span> (<span class="math inline">\(a_k\)</span>) are now creating (annihilating) an electron in the spin orbital <span class="math inline">\(\phi_k\)</span> and the tensors <span class="math inline">\(\tilde{h}^{i}_{j}\)</span> and <span class="math inline">\(\tilde{g}^{ij}_{kl}\)</span> are integrals over the one- and two-body operators and the spin orbitals. The one-body integrals are then given by <span class="math display">\[
\tilde{h}^{i}_{j} = h^{\lfloor{i/2}\rfloor}_{\lfloor{j/2}\rfloor} \langle \sigma_i \vert \sigma_j  \rangle
\]</span> with the spatial part <span class="math display">\[ h^{k}_{l} =  \langle k \rvert h \lvert l \rangle \equiv \int \psi_k^*(r) h(r) \psi_l(r) \operatorname{d}r. \]</span> In the same way, the spatial part of the two-body integrals is given by <span class="math display">\[ g^{ij}_{kl} = \langle i j \rvert g_{12}  \lvert k l \rangle \equiv \int \int \psi_i^*(r_1) \psi_j^*(r_2) \frac{1}{|r_1-r_2|} \psi_k(r_1) \psi_l(r_2) \operatorname{d}r_1 \operatorname{d}r_2.  \]</span> Note that there exist three different short notations <span class="math display">\[ \langle ij\vert kl \rangle \equiv \left(ik \vert jl \right) \equiv \left[ ij  \vert lk \right]  \]</span> usually referred to as Dirac (physicist, 1212), Mulliken (chemist, 1122) and openfermion (google, 1221) notations. Depending on the convention used, the meaning of the indices <span class="math inline">\(g^{ij}_{kl}\)</span> changes. This is a bit inconvenient, but we can’t change it anymore. Most quantum chemistry packages (pyscf, psi4) use the Mulliken convention, some quantum computing packages adopted the google convention, and the Dirac convention is often found in articles. In the tequila package we tried to automatize most of it away for user convenience. Here is a small example on how to get the integrals using tequila (with either pyscf or psi4 in the back):</p>
<div id="f3ae27f9" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tequila <span class="im">as</span> tq</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>geometry <span class="op">=</span> <span class="st">"Be 0.0 0.0 0.0"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>mol <span class="op">=</span> tq.Molecule(geometry<span class="op">=</span>geometry, basis_set<span class="op">=</span><span class="st">"6-31G"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>c,h,g <span class="op">=</span> mol.get_integrals(two_body_oderings<span class="op">=</span><span class="st">"mulliken"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>for most applications, the integrals are however processed automatically in the back.</p>
</section>
<section id="example-and-comparison" class="level2">
<h2 class="anchored" data-anchor-id="example-and-comparison">Example and Comparison</h2>
<p>Let’s look at first and second quantized Hamiltonians and wavefunctions in an explicit example: The Helium atom (charge <span class="math inline">\(N_\text{He}=2\)</span> and nuclear coordinate <span class="math inline">\(R_\text{He} = (0,0,0)\)</span>) in a basis of two spatial orbitals <span class="math inline">\(\left\{\psi_0, \psi_1 \right\}\)</span>.</p>
<section id="first-quantization" class="level3">
<h3 class="anchored" data-anchor-id="first-quantization">First Quantization</h3>
<p>For the neutral electron with 2 electrons, the Hamiltonian is:<br>
<span class="math display">\[
H(r_1,r_2) = -\frac{\nabla^2}{2} - \frac{\nabla^2}{2} - \frac{2}{\|r_1\|} - \frac{2}{\|r_2\|} + \frac{1}{\|r_1 - r_2 \|}  
\]</span> and a general two-electron Slater-determinant is written as<br>
<span class="math display">\[
\det\left(\phi_k,\phi_l\right) = \frac{1}{\sqrt{2}} \left( \phi_k(r_1) \phi_l(r_2) - \phi_l(r_1) \phi_k(r_2) \right).
\]</span></p>
<p>All possible Slater-determinants in the given basis:</p>
<ul>
<li><p>closed-shell singlets (both electrons in the same spatial orbital):<br>
<span class="math display">\[
\det\left(\phi_0 \phi_1 \right) = \frac{1}{\sqrt{2}}\psi_0(r_1) \psi_0(r_1) \otimes \left( \lvert \downarrow \uparrow \rangle - \lvert \uparrow \downarrow \rangle \right)
\]</span> <span class="math display">\[
\det\left(\phi_3 \phi_4\right) = \frac{1}{\sqrt{2}}\psi_1(r_1) \psi_1(r_1) \otimes \left( \lvert \downarrow \uparrow \rangle - \lvert \uparrow \downarrow \rangle \right)
\]</span></p></li>
<li><p>open-shell polarized triplets:<br>
<span class="math display">\[
\det\left(\phi_1 \phi_3\right) = \left(\psi_0(r_1) \psi_1(r_2) + \psi_1(r_1) \psi_0(r_2)\right) \otimes \left( \lvert \uparrow \uparrow \rangle  \right)
\]</span></p></li>
</ul>
<p><span class="math display">\[
\det\left(\phi_2 \phi_4\right) = \left(\psi_0(r_1) \psi_1(r_2) + \psi_1(r_1) \psi_0(r_2)\right) \otimes \left( \lvert \downarrow \downarrow \rangle  \right)
\]</span></p>
<ul>
<li>open-shell (with broken spin symmetry - recombinable into non-polarized triplet state and one additional singlet state):<br>
<span class="math display">\[
\det\left(\phi_0\phi_2\right) = \frac{1}{\sqrt{2}}\left(\phi_0(x_1) \phi_2(x_2) - \phi_2(x_1) \phi_0(x2) \right)
\]</span> <span class="math display">\[
\det\left(\phi_1\phi_3\right) = \frac{1}{\sqrt{2}}\left(\phi_1(x_1) \phi_3(x_2) - \phi_3(x_1) \phi_1(x2) \right)
\]</span></li>
</ul>
<p>A general two-electron wavefunction can then be written as a linear combination of those 6 Determinants (note however, that the different spin-symmetries, i.e.&nbsp;the triplet and the two singlets, usually don’t mix) <span class="math display">\[
\Psi(x_1,x_2) = \sum_{i&lt;j\in\left\{0,1\right\}} d_{ij} \det\left(\phi_i\phi_j\right)
\]</span> Note how this always denotes a two-electron wavefunction. The electron number directly enters the definition of the first quantized Hamiltonian and therefore defines the space onto which the Hamiltonian acts.</p>
<p>For numerical procedures it is often necessary to directly express the Hamiltonian in the given basis. Here this would mean to compute all matrix elements <span class="math display">\[
H_{ij} = \langle \det\left(\phi_m\phi_n\right)\rvert H \lvert \det\left(\phi_k\phi_l\right) \rangle.
\]</span> In this two electron example this is no problem, the task of computing all matrix elements will however become unfeasible with growing electron number due to the growth of possible determinants. Explicit computation of the Hamiltonian in the given basis is usually only performed within further approximations - e.g.&nbsp;truncated configuration interaction methods that only include slater determinants that differ in a specific number of orbitals from a given reference determinant.</p>
</section>
<section id="second-quantized-formulation" class="level3">
<h3 class="anchored" data-anchor-id="second-quantized-formulation">Second Quantized Formulation</h3>
<p>In second quantization it is sufficient to compute the one- and two-body integrals given above to define the Hamiltonian. They grow with the fourth power of the basis size rendering the task always feasible.<br>
A general wavefunction can be constructed from all possible linear combinations of electronic configurations in the given spin-orbital basis - denoted by so called occupation vectors representing which spin orbitals are occupied and not. In this case we have 4 spin orbitals then therefore <span class="math inline">\(2^4=16\)</span> different configurations:</p>
<ul>
<li><p>vacuum<br>
<span class="math display">\[\lvert 0000 \rangle\]</span></p></li>
<li><p>single electron<br>
<span class="math display">\[
\lvert 1000 \rangle, \vert 0100 \rangle, \lvert 0010 \rangle, \lvert 0001\rangle,
\]</span></p></li>
<li><p>two electrons<br>
<span class="math display">\[
\lvert 1100 \rangle, \lvert 0011 \rangle, \lvert 1001 \rangle, \lvert 0110 \rangle, \lvert 1010\rangle, \lvert 0101 \rangle,
\]</span></p></li>
<li><p>three electrons<br>
<span class="math display">\[
\lvert 1110 \rangle, \lvert 1101 \rangle, \lvert 1011 \rangle, \lvert 0111 \rangle,
\]</span></p></li>
<li><p>four-electrons<br>
<span class="math display">\[
\lvert 1111 \rangle.
\]</span></p></li>
</ul>
<p>A general wavefunction is then given by<br>
<span class="math display">\[\lvert \Psi \rangle = \sum_{k=0}^{16} c_k \lvert \text{binary}(k) \rangle.\]</span></p>
</section>
</section>
</section>
<section id="further-reading" class="level1">
<h1>Further Reading</h1>
<ul>
<li><a href="https://arxiv.org/abs/2008.02819">Section I</a>: Brief summary about electronic Hamiltonians</li>
<li><a href="https://arxiv.org/pdf/2101.08448.pdf">Section VI.A.2</a>: Brief summary and resources for qubit encodings</li>
<li><a href="https://archiv.ub.uni-heidelberg.de/volltextserver/24519/7/dissertation.pdf">Chapters 2,4</a>: Detailed and mathematically sound introdution</li>
<li><a href="https://edoc.hu-berlin.de/bitstream/handle/18452/20118/dissertation_kottmann_jakob.pdf">Chapter 1</a>: Brief mathematical introduction about single and multi electron spaces</li>
<li><a href="https://simons.hec.utah.edu/Books.html">Book from Jack Simons</a>: Good intruction for second quantization in quantum chemistry</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/thuytr18\.github\.io\/tequila-tutorials-beta\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="toc-actions"><ul><li><a href="https://github.com/tequilahub/tequila/blob/main/Researches 2/electronic-hamiltonians/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/tequilahub/tequila/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>